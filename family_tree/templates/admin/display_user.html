{% extends 'base.html' %}

{% block title %}Delete User - Admin Dashboard{% endblock %}

{% block content %}
<!-- Main Content -->
<div class="container mt-5">
    {% if user %}
        <div class="row justify-content-center">
            <div class="col-lg-8 col-md-10">
                <!-- Warning Header -->
                <div class="card border-0 shadow-lg rounded-4 mb-4">
                    <div class="card-header bg-danger bg-opacity-10 border-0 py-4">
                        <div class="d-flex align-items-center">
                            <div class="bg-danger bg-opacity-20 rounded-3 p-3 me-3">
                                <i class="fas fa-exclamation-triangle text-danger fs-4"></i>
                            </div>
                            <div>
                                <h5 class="card-title fw-bold mb-1 text-danger">Confirm User Deletion</h5>
                                <small class="text-muted">This action cannot be undone</small>
                            </div>
                        </div>
                    </div>

                    <div class="card-body p-4">
                        <div class="alert alert-danger border-0 mb-4">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-info-circle me-3 fs-4"></i>
                                <div>
                                    <h6 class="alert-heading fw-bold mb-1">Warning: Permanent Action</h6>
                                    <p class="mb-0">Deleting this user will permanently remove all their data from the system, including their family tree information, contacts, and addresses.</p>
                                </div>
                            </div>
                        </div>

                        <!-- User Information -->
                        <div class="row g-4 mb-4">
                            <div class="col-md-6">
                                <div class="card border-0 bg-light h-100">
                                    <div class="card-body p-4">
                                        <h6 class="fw-bold text-primary mb-3">
                                            <i class="fas fa-user me-2"></i>User Information
                                        </h6>
                                        <div class="user-details">
                                            <div class="d-flex align-items-start mb-3">
                                                <i class="fas fa-id-card text-primary me-3 mt-1"></i>
                                                <div>
                                                    <strong class="text-dark">Username:</strong>
                                                    <div class="text-muted mt-1">{{ user.username }}</div>
                                                </div>
                                            </div>

                                            <div class="d-flex align-items-start mb-3">
                                                <i class="fas fa-envelope text-primary me-3 mt-1"></i>
                                                <div>
                                                    <strong class="text-dark">Email:</strong>
                                                    <div class="text-muted mt-1">{{ user.email }}</div>
                                                </div>
                                            </div>

                                            <div class="d-flex align-items-start">
                                                <i class="fas fa-calendar text-primary me-3 mt-1"></i>
                                                <div>
                                                    <strong class="text-dark">Member Since:</strong>
                                                    <div class="text-muted mt-1">{{ user.date_created.strftime('%B %d, %Y') if user.date_created else 'Unknown' }}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="card border-0 bg-light h-100">
                                    <div class="card-body p-4">
                                        <h6 class="fw-bold text-primary mb-3">
                                            <i class="fas fa-user-circle me-2"></i>Personal Information
                                        </h6>
                                        <div class="personal-details">
                                            <div class="d-flex align-items-start mb-3">
                                                <i class="fas fa-user text-primary me-3 mt-1"></i>
                                                <div>
                                                    <strong class="text-dark">Full Name:</strong>
                                                    <div class="text-muted mt-1">
                                                        {{ user.person.first_name + (' ' + user.person.middle_name if user.person.middle_name else '') + ' '+ user.person.last_name }}
                                                    </div>
                                                </div>
                                            </div>

                                            {% if user.person.gender %}
                                            <div class="d-flex align-items-start mb-3">
                                                <i class="fas fa-venus-mars text-primary me-3 mt-1"></i>
                                                <div>
                                                    <strong class="text-dark">Gender:</strong>
                                                    <div class="text-muted mt-1">{{ user.person.gender|capitalize }}</div>
                                                </div>
                                            </div>
                                            {% endif %}

                                            <div class="d-flex align-items-start">
                                                <i class="fas fa-shield-alt text-primary me-3 mt-1"></i>
                                                <div>
                                                    <strong class="text-dark">Account Type:</strong>
                                                    <div class="text-muted mt-1">
                                                        <span class="badge bg-{{ 'danger' if user.is_admin else 'primary' }} bg-opacity-10 text-{{ 'danger' if user.is_admin else 'primary' }} px-3 py-2 rounded-pill">
                                                            {{ 'Administrator' if user.is_admin else 'Regular User' }}
                                                        </span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Data Impact Warning -->
                        <div class="card border-0 bg-warning bg-opacity-10 mb-4">
                            <div class="card-body p-4">
                                <div class="d-flex align-items-start">
                                    <i class="fas fa-database text-warning me-3 mt-1"></i>
                                    <div>
                                        <h6 class="fw-bold text-warning mb-2">Data That Will Be Deleted</h6>
                                        <ul class="list-unstyled mb-0 small text-muted">
                                            <li class="mb-1">
                                                <i class="fas fa-users me-2"></i>
                                                All family relationships and connections
                                            </li>
                                            <li class="mb-1">
                                                <i class="fas fa-map-marker-alt me-2"></i>
                                                All addresses and location information
                                            </li>
                                            <li class="mb-1">
                                                <i class="fas fa-phone me-2"></i>
                                                All contact details and phone numbers
                                            </li>
                                            <li class="mb-1">
                                                <i class="fas fa-calendar-alt me-2"></i>
                                                All important dates and events
                                            </li>
                                            <li class="mb-0">
                                                <i class="fas fa-user-circle me-2"></i>
                                                Profile information and account data
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="row g-3">
                            <div class="col-md-6">
                                <form method="POST" action="{{ url_for('admin.delete_user', user_id=user.id) }}" class="d-inline w-100">
                                    <button type="submit" class="btn btn-danger btn-lg w-100 rounded-pill fw-semibold">
                                        <i class="fas fa-trash me-2"></i>Yes, Delete User
                                    </button>
          </form>
                            </div>
                            <div class="col-md-6">
                                <a href="{{ url_for('admin.display_users') }}" class="btn btn-outline-secondary btn-lg w-100 rounded-pill fw-semibold">
                                    <i class="fas fa-times me-2"></i>Cancel
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Additional Warning -->
                <div class="card border-0 shadow-sm rounded-4">
                    <div class="card-body p-4">
                        <div class="d-flex align-items-start">
                            <div class="bg-info bg-opacity-10 rounded-3 p-2 me-3">
                                <i class="fas fa-lightbulb text-info"></i>
                            </div>
                            <div>
                                <h6 class="fw-bold mb-2">Alternative Actions</h6>
                                <p class="text-muted mb-0 small">
                                    Instead of deleting the user, consider deactivating their account or contacting them directly. 
                                    User deletion should only be used for accounts that are no longer needed and have no valuable data.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
      </div>
    {% else %}
        <!-- User Not Found State -->
        <div class="row justify-content-center">
            <div class="col-lg-6">
                <div class="card border-0 shadow-sm text-center rounded-4">
                    <div class="card-body py-5">
                        <div class="mb-4">
                            <i class="fas fa-user-slash text-muted" style="font-size: 4rem;"></i>
                        </div>
                        <h4 class="fw-bold text-muted mb-3">User Not Found</h4>
                        <p class="text-muted mb-4">
                            The requested user could not be found in the system. 
                            They may have already been deleted or the link is invalid.
                        </p>
                        <a href="{{ url_for('admin.display_users') }}" class="btn btn-primary btn-lg rounded-pill">
                            <i class="fas fa-arrow-left me-2"></i>Back to Users
                        </a>
                    </div>
                </div>
            </div>
        </div>
    {% endif %}
  </div>
{% endblock %}
